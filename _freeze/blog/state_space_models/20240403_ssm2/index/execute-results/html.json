{
  "hash": "0d54176db945f109a978846571f52ee8",
  "result": {
    "markdown": "---\ntitle: \"State Space Models - Teil 2\"\ndescription: \"Es geht weiter in der Space Saga. Wir callen nicht nur die Anzahl der bisherigen Parameter von zuletzt, wir raisen sogar. Das bringt Turbulenzen in den Alltag so mancher Algorithmen. Soviel kann ebenfalls noch verraten: Wir müssen einen Slope finden und es gibt wieder nice Grafiken zum watchen!\"\nauthor: Manuel Reif \ndate: 2024-05-20\nlang: de\ncategories: [R, stan, state-space-models]\ndraft: false \nhighlight-style: monokai\nimage: media/startbild2.png\nformat:\n  html:\n    css: ssm2.css\nexecute:\n    eval: false\n    message: false\n    echo: false\n    warning: false\nbibliography: ../texts.bib\nfilters:\n   - include-code-files\n---\n\n\n# Local Linear Trend Model\n\n\n\n\n::: {.cell}\n\n:::\n\n\n<img src=\"media/more_parameters.gif\" alt=\"State Space Model\" style=\"float: right; width: 40%; margin-left: 20px; margin-bottom: 10px;\"/>\n\nOk, bisher hatten wir nur einen Intercept in unserem State Space Model\nder sich je nach Daten \"random\" bewegt. Zusätzlich nimmt man an, dass man einen \nMeasurement Error hat ([siehe dazu auch Teil 1 zu den State-Space Models](../20240303_ssm1)).\nDas Ganze schaut ziemlich spektakulär aus, endete aber\ndamit, dass die Forecasts Konstanten sind. Wenn wir aber davon ausgehen,\ndass sich bestehende Trends in die Zukunft fortsetzen können, ist das sicher \nkein ideales Modell. Es ist zu naiv und zu einfach gestrickt. Wir wollen \naber nicht judgy sein -- jeder von uns ist mal naiv -- das macht uns alle zu \nModellen.\n\nHier wird es jetzt richtig abgestatespaced, denn wir wollen viel mehr als\nwir bisher von diesen Modellen bekommen haben!\nUnd das bekommen wir nur wenn wir **noch mehr Parameter** an diese Modelle \nverfüttern!\nAlso droppen wir einfach einen Parameter rein -- oder vielleicht nicht nur einen alleine\nsondern wir klotzen einfach analog zum Style des bisherigen State Space Models\nfür jeden Zeitpunkt einen eigenen Parameter dazu! Der Slope soll sich also je \nnach Zeitpunkt ändern können. Das klingt extrem wild weil es extrem wild ist.\n\n## Was ist neu?\n\nBevor wir aber die Anzahl der Parameter radikal erhöhen, gehen wir einen Schritt \nzurück und betrachten ein Modell das angenhem wenig Parameter hat und stellen uns\ndie Frage:\nWie schaut denn eigentlich ein Slope in einem einfachen linearen Modell \n(Einfachregression) aus? Unten\nist eben dieses Modell dargestellt. \nDer Slope ($\\beta_1$) gibt die Veränderung von y an, wenn x um **eine Einheit** \ngrößer wird. Also konkret: wenn $\\beta_1 = 2$ ist, dann erhöht sich y um 2 wenn \nx sich um 1 erhöht.\nThat's it. \n\n\n```{=tex}\n\\begin{align}\ny &= \\alpha + \\beta_1\\,x + \\epsilon & |  \\quad \\alpha = Intercept,\\,\\beta_1 = Slope\n\\end{align}\n```\n\n\n\n<img src=\"media/where_slope_pic.jpg\" alt=\"State Space Model\" style=\"float: left; width: 28%; margin-right: 20px; margin-bottom: 10px;\"/>\n\nMit diesem Wissen im Hinterkopf schauen wir uns nun das erweiterte State-Space Model wie es \nhier unten angeführt ist. Es gibt einen neuen Parameter $\\nu$ und schon wieder \neinen Error $\\zeta$, den wir mal wieder als normalverteilt annehmen. Laut Lehrbuch\nsind die drei Gleichungen dann das State-Space Model mit Slope. Die\nFrage die sich aufdrängt ist: Wo ist hier denn eigentlich jetzt der Slope? Und als\nergänzende Frage: In einem linearen Modell hab ich eine Variable x die y \nerklären soll. Also z. B. soll die Körpermasse durch die Körperhöhe erklärt oder\nvorhergesagt werden -- d. h. es gibt 2 Variablen. In unserem State Space Model haben\nwir (bis jetzt) nur eine einzige Variable -- nämlich die Werte die y in der\nZeitreihe annimmt.\n\n\n\n\n```{=tex}\n\\begin{align}\ny_t &= \\tau_t + \\epsilon_t  & \\epsilon_t &\\sim \\mathcal{N}(0, \\sigma_{\\epsilon}) \\label{eq:ssm2-slope1}\\\\\n\\tau_{t+1} &= \\tau_{t} + \\nu_{t} + \\xi_{t} & \\xi_{t}&\\sim \\mathcal{N}(0, \\sigma_{\\xi})\\\\\n\\nu_{t+1} &= \\nu_{t} + \\zeta_{t} & \\zeta_{t}&\\sim \\mathcal{N}(0, \\sigma_{\\zeta})\n\\end{align}\n```\n\n\n\nAlso schauen wir uns das mal genauer an. Wir gehen genauso vor wie\nin @ssm-book-intro2007 dargestellt und nehmen an, dass $\\xi_1 = 0$ und $\\zeta_1 = 0$.\nDas machen wir um uns die lästigen Random Effects Terme in weiterer Folge zu ersparen, also \num das Ganze einfacher zu gestalten. Wenn wir diese Terme 0 setzen, fällt es deutlich leichter\nherauszufinden wo denn nun eigentlich der Slope und das x versteckt sind.\nAlso wir beginnen bei $t = 1$, also der ersten Beobachtung. \n\n\n::: {.callout-tip icon=\"false\"}\n## $t = 1$\n\n\n```{=tex}\n\\begin{align}\ny_1 &= \\tau_1 + \\epsilon_1\\\\\n\\tau_{2} &= \\tau_{1} + \\nu_{1} + \\xi_{1} \\quad \\rightarrow \\quad \\xi_{1} = 0 \\quad \\rightarrow \\quad \\tau_{2} = \\tau_{1} + \\nu_{1} \\\\\n\\nu_{2} &= \\nu_{1} + \\zeta_{t} \\quad \\quad \\quad \\, \\rightarrow  \\quad \\zeta_{t} = 0 \\quad \\rightarrow \\quad  \\nu_{2} = \\nu_{1}\\\\\n&\\text{das heisst:}\\\\\n\\tau_{2} &= \\tau_{1} + \\nu_{1} &\\\\\n\\nu_{2} &= \\nu_{1} &\n\\end{align}\n```\n\n:::\n\n\nDie wesentlichste Erkenntnis bei  $t = 1$ ist, dass $\\nu_{2} = \\nu_{1}$ \n(weil $\\zeta_{t} = 0$).\nWir bewegen uns in weiterer Folge die Timeline nach vorne. Wir rattern (fast)\nalle Zeitpunkte (t) durch, und versuchen alle Terme die uns bekannt vorkommen\ngeschickt zu substituieren und zusammenzufassen. \nDabei sammeln wir immer mehr $\\nu$s zusammen, die ja alle gleich zu sein scheinen.\nDaher fassen wir sie als ein Vielfaches von $\\nu_1$ kompakt zusammen.\n\n\n::: {.callout-tip icon=\"false\"}\n## $t = 2$\n\n```{=tex}\n\\begin{align}\ny_2 &= \\tau_2 + \\epsilon_2\\\\\ny_2 &= \\underbrace{\\tau_{1} + \\nu_{1}}_{\\tau_2} + \\epsilon_2 \\quad | \\quad \\tau_2 \\text{ eingesetzt von t = 1}\\\\\n\\\\\n\\hline \\\\\n\\tau_{3} &= \\tau_{2} + \\nu_{2} \\\\\n\\tau_{3} &= \\underbrace{\\tau_{1} + \\nu_{1}}_{\\tau_2} + \\nu_{2} \\quad | \\quad \\tau_2 \\text{ eingesetzt von t = 1} \\\\\n\\tau_{3} &= \\tau_{1} + \\nu_{1} + \\nu_{1} \\quad | \\quad \\nu_2 = \\nu_1 \\text{ eingesetzt von t = 1}\\\\\n\\tau_{3} &= \\tau_{1} + 2\\,\\nu_{1} \\\\\n\\\\\n\\hline \\\\\n\\nu_{3} &= \\nu_{2}\n\\end{align}\n```\n\n:::\n\n\n::: {.callout-tip icon=\"false\"}\n## $t = 3$\n\n```{=tex}\n\\begin{align}\ny_3 &= \\tau_3 + \\epsilon_3\\\\\ny_3 &= \\tau_{1} + 2\\,\\nu_{1} + \\epsilon_3\\\\\n\\\\\n\\hline \\\\\n\\tau_{4} &= \\tau_{3} + \\nu_{3} \\\\\n\\tau_{4} &= \\underbrace{\\tau_{1} + 2\\,\\nu_{1}}_{\\tau_3} + \\nu_{3} \\quad | \\quad \\tau_3 \\text{ eingesetzt von t = 2} \\\\\n\\tau_{4} &= \\tau_{1} + 2\\,\\nu_{1} + \\nu_{1} \\quad | \\quad \\nu_2 = \\nu_1 \\text{ und } \\nu_3 = \\nu_2 \\,\\text{ daher: } \\nu_3 = \\nu_1 \\\\\n\\tau_{4} &= \\tau_{1} + 3\\,\\nu_{1} \\\\\n\\\\\n\\hline \\\\\n\\nu_{4} &= \\nu_{3}\n\\end{align}\n```\n\n:::\n\nOk, nach $t = 3$ ist das Prinzip halbwegs klar geworden und wir können mit länger\ndraufschauen ein allgemeines Prinzip herleiten.\nDamit sehen wir **warum** $\\nu$ \nder Slope ist und dass alles an **t** hängt.\nDenn wenn die Zeit um eine Einheit fortschreitet, wird immer genau $\\nu$ dazuaddiert.\nIn unserem Fall sind alle $\\nu$s ident, also wird immer dieselbe Konstante\ndazuaddiert. Das entspricht genau der Definition eines Slopes wie wir es oben \nim einfachen linearen Modell gesehen haben.\n\nKurz: Wenn man also den Random Term $\\zeta$\nweglässt, ist $\\nu$ der Slope der den globalen Anstieg darstellt, quasi\nwie stark y steigt wenn die Zeit um eine Einheit steigt!\nTbh: Ohne den ganzen Random-Terms ist das auch wirklich einfacher zu erkennen. \n\n\n::: {.callout-tip icon=\"false\"}\n## state equations allgemein\n\n```{=tex}\n\\begin{align}\ny_t &= \\tau_t + \\epsilon_t\\\\\ny_t &= \\tau_1 + \\nu_1\\,g_t + \\epsilon_t \\quad \\text{wobei:} \\quad g_t = t - 1\n\\end{align}\n```\n\n:::\n\n\nJetzt kennen wir den Sinn der neuen Parameter. Allerdings ist die Frage wie denn\nnun die Parameter zusammenspielen? Kann man diese auch genügend gut auseinanderhalten?\nWenn ich eine lineare Regression ansehe, kann ich vielleicht den Slope erraten.\nKann ich das hier auch? Wie schauen Daten aus die mit einer bestimmten Parameterkombination\nsimuliert werden?\n\n\n## Simulation\n\nInteressant ist: Mit den selben Parametern kann der Verlauf völlig unterschiedlich aussehen\nwie man in Abbildung @fig-sim-slope1 und @fig-sim-slope2 sehen kann! Das \nist insofern nicht verwunderlich, als ja nur die Standardabweichungen\ndefiniert sind und somit ein \"rauf\" oder \"runter\" sich im Wesentlichen\ndurch Zufall ergibt!\nEs wäre jedenfalls interessant zu sehen und verstehen wie \"random\" diese\nVerläufe nun wirklich sind. Dafür reichen 2 Simulationen nicht -- wir brauchen\nmehr simulierte Zeitreihen.\n\n::: {.panel-tabset}\n\n## Erste Simulation\n\n\n::: {.cell}\n\n:::\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Grafik mit simulierten Daten\"}\nsubtxt = \"$\\\\sigma_{\\\\xi} = [sd_xi];\n\\\\phantom{x} sigma_{\\\\epsilon} = [sd_epsilon];\n\\\\phantom{x}  sigma_{\\\\zeta} = [sd_zeta]$\"  \n\nsubtxt_glued = glue(subtxt, .open = \"[\", .close = \"]\", \n                    sd_zeta = 0.1, \n                    sd_epsilon = 2, \n                    sd_xi = 1,\n                    slope = 0)\n\np1 = ggplot(data = dat1_drift, aes(x = time, y = y)) + \n    geom_point(shape = 1, alpha = 0.8) + \n    geom_step(aes(y = true_values), color = paletteer_d(\"trekcolors::starfleet\")[2]) +\n    labs(title = \"Simulation 1 - State Space Model\", subtitle = latex2exp::TeX(subtxt_glued)) +\n    ssm_theme2() +\n    theme(axis.text.x =  element_text(family = \"barr\", face = \"plain\"))\n\np1\n```\n\n::: {.cell-output-display}\n![Simulierte Daten 1](index_files/figure-html/fig-sim-slope1-1.png){#fig-sim-slope1 width=864}\n:::\n:::\n\n\n## Zweite Simulation\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code: Grafik mit simulierten Daten\"}\np1 = ggplot(data = dat1_drift2, aes(x = time, y = y)) + \n    geom_point(shape = 1, alpha = 0.8) + \n    geom_step(aes(y = true_values), color = paletteer_d(\"trekcolors::starfleet\")[2]) +\n    labs(title = \"Simulation 2 - State Space Model\", subtitle = latex2exp::TeX(subtxt_glued)) +\n    ssm_theme2() + \n    theme(axis.text.x =  element_text(family = \"barr\", face = \"plain\"))\n\np1\n```\n\n::: {.cell-output-display}\n![Simulierte Daten 2](index_files/figure-html/fig-sim-slope2-1.png){#fig-sim-slope2 width=864}\n:::\n:::\n\n\n:::\n\n\nWir betrachten hier also gleich 1000 Simulationen gleichzeitig, um zu sehen, \ninwiefern sich die Verläufe voneinander\nunterscheiden und auch wie die unterschiedlichen Parameter des State Space Models \nineinander greifen.\nAlso: Was für einen Unterschied macht es eigentlich, wenn die Parameter sich ändern?\n\nUm auch einen fixen Trend in der Simulation einbauen zu können, wurde hier\ndas State Space Model um einen Parameter $\\beta$ erweitert, der den langfristigen,\nzeitunabhängigen overall Trend der Zeitreihe angibt.\n\n\n```{=tex}\n\\begin{align}\ny_t &= \\tau_t + \\epsilon_t  & \\epsilon_t &\\sim \\mathcal{N}(0, \\sigma_{\\epsilon})\\\\\n\\tau_{t+1} &= \\tau_{t} + \\beta + \\nu_{t} + \\xi_{t} & \\xi_{t}&\\sim \\mathcal{N}(0, \\sigma_{\\xi})\\\\\n\\nu_{t+1} &= \\nu_{t} + \\zeta_{t} & \\zeta_{t}&\\sim \\mathcal{N}(0, \\sigma_{\\zeta})\n\\end{align}\n```\n\n\nAnhand der bloßen Verläufe kann man die Ausprägungen der Parameter kaum abschätzen \n(siehe jeweils das oberste Panel z. B. in @fig-sim1000-1 ff.). Die 1000 simulierten Zeitreihen \nstarten an der selben Position und ergeben zusammengenommen einen \ntrichterartigen Verlauf. Wie weit die Linien auseinandergehen hängt von den\nParametern ab. Das Auge erkennt aber nicht welcher Parameter nun welche Ausprägung\nhat.\n\n\n<img src=\"media/autoreg.jpg\" alt=\"State Space Model\" style=\"float: right; width: 40%; margin-left: 20px; margin-bottom: 10px;\"/>\n\nDabei hilft uns der Density Plot, der immer im 2. Panel zu sehen ist.\nDie Density beschreibt die Häufigkeit, wie oft der nachfolgende True Value größer ist\nals der aktuelle True Value. Sammelt sich die meiste Masse in der Mitte, bedeutet das,\ndass es ein Coinflip ist ob der nächste Wert höher ist oder nicht. Sammelt sich\ndie Masse an den Enden, bedeutet das, dass die Zeitreihe eine eindeutige \"Meinung\" \nbezüglich des nachfolgenden Werts hat. Entweder ist die Wahrscheinlichkeit deutlich\nzugunsten eines höheren oder eines niedrigeren Werts.\nWenn $\\sigma_{\\zeta}$ klein ist, sammelt sich die Masse in der Mitte. Dann \nstehen die Chancen eben Fifty Fifty ob der nächste Wert höher ist oder nicht.\nWenn $\\sigma_{\\zeta}$ im Verhältnis größer wird, dann gibt es eindeutige Häufigungen\nan den Rändern. Dann bleibt der Wert quasi hoch, wenn er zuvor hoch war,\noder niedrig wenn er zuvor niedrig war.\n\nIn Panel 3 wird die Autokorrelation mit den letzten 15 Werten dargestellt. \nDie senkrechte strichlierte Linie reicht bis\nzum Median der Korrelation über die 1000 Simulationen, während die Box den Abstand zwischen\ndem 25\\ % Percentil und dem 75\\ % Percentil darstellen -- also im Wesentlichen\ndie Box eines Boxplots darstellt. In allen Zeitreihen ist die mittlere\nAutokorrelation vergleichbar groß -- allerdings ist die Schwankung bei $\\beta = 0$ und \nniedrigem $\\sigma_{\\zeta}$ am höchsten.\n\n\nMeine Conclusio aus diesen Simulationen ist:\n\n1. Aus einer Zeitreihe die jweiligen Parameter intuitiv zu schätzen scheint \nunmöglich (für mich)\n2. Weil alle Zeitreihen irgendwie gleich aussehen\n3. Die Unterschiede zeigen sich, wenn man sich 2 aufeinanderfolgende Werte ansehen.\n\n\n\n::: {.panel-tabset}\n\n## Sim 1\n\n\n::: {.cell fig.showtext='true'}\n::: {.cell-output-display}\n![1000 Mal Daten simuliert ohne fixen Trend. Hohe Varianz bei ξ, niedrige bei ζ.](index_files/figure-html/fig-sim1000-1-1.png){#fig-sim1000-1 width=864}\n:::\n:::\n\n\n## Sim 2\n\n\n::: {.cell fig.showtext='true'}\n::: {.cell-output-display}\n![1000 Mal Daten simuliert ohne fixen Trend. Varianz bei ξ und ζ gleich hoch.](index_files/figure-html/fig-sim1000-2-1.png){#fig-sim1000-2 width=864}\n:::\n:::\n\n\n## Sim 3\n\n\n::: {.cell fig.showtext='true'}\n::: {.cell-output-display}\n![1000 Mal Daten simuliert ohne fixen Trend. Niedrige Varianz bei ξ, hohe bei ζ.](index_files/figure-html/fig-sim1000-3-1.png){#fig-sim1000-3 width=864}\n:::\n:::\n\n\n## Sim 4\n\n\n::: {.cell fig.showtext='true'}\n::: {.cell-output-display}\n![1000 Mal Daten simuliert mit fixem Trend. Hohe Varianz bei ξ, niedrige bei ζ.](index_files/figure-html/fig-sim1000-4-1.png){#fig-sim1000-4 width=864}\n:::\n:::\n\n\n## Sim 5\n\n\n::: {.cell fig.showtext='true'}\n::: {.cell-output-display}\n![1000 Mal Daten simuliert mit fixem Trend. Gleich hohe Varianz bei ξ und ζ.](index_files/figure-html/fig-sim1000-5-1.png){#fig-sim1000-5 width=864}\n:::\n:::\n\n\n:::\n\n\n\n## `stan` konvergiert nicht\n\nIch mache es kurz. Es ist viel Zeit draufgegangen um diese Modelle in Stan laufen zu lassen.\nAuch mit $> 10 000$ Samples konvergierten die Modelle nicht wenn man sie so\nsimpel implementiert wie ich das geplant hatte.\nDaher wurden für diese Modelle andere Packages verwendet.\n\n\n```{.stan include=\"stan/02_drift_model.stan\"}\n\n```\n\n\n\n::: {.cell}\n\n:::\n\n\n## `statespacer`, `KFAS` und `MARSS` springen ein\n\nDie gefailte ad-hoc Implementierung des State-Space Models in `stan`\nlöst unmittelbar roten Alarm aus.\nNun darf nicht an der falschen Stelle gespart werden. Als Ersatz werden\n3 großartige andere R packages nominiert um den Tag zu retten.\n`statespacer` is kein Neuling hier, denn es kam auch schon in \n[Teil 1](../20240303_ssm1) zum Einsatz. Es bringt auch noch seine Freunde\n[KFAS](https://cran.r-project.org/web/packages/KFAS/index.html) und [MARSS](https://atsa-es.github.io/MARSS/) mit. \nMit der Hoffnung, dass nicht wie im alten Sprichwort viele R-Packages \ndas State-Space Kontinuum verzerren.\n\n<img src=\"media/three_pack.jpg\" alt=\"State Space Model\" style=\"float: left; width: 34%; margin-right: 20px; margin-bottom: 10px;\"/>\n\nDie 3 sollen nun die erste Simulation, die in @fig-sim-slope2 \nzu sehen ist, fitten! Die gefitteten Zeitreihen samt Forecast für die nächsten \n25 Zeitpunkte ist in @fig-ssm2-statespacer-dygraph1 zu sehen!\nDas Ergebnis ist nun etwas spannender als zuletzt, denn wir haben jetzt\nkeine langweilige horizontale Linie mehr, sondern der Predict ist bei allen \nunseren Modellen eine Gerade mit positiven Slope.\nIntuitiv passt das auch wenn man die Zeitreihe betrachtet, denn sie steigt ja\nsichtlich auch über die Zeit. Tatsächlich wurde die Zeitreihe aber ohne 'stabilen'\nSlope simuliert und trotzdem wird ein weiter steigender Trend vorhergesagt. \nAlle 3 Modelle 'erkennen' offensichtlich diesen 'Trend' und setzen ihn auch fort.\nWährend bei `statespacer` und `KFAS` bezüglich des Slopes weitgehend Einigkeit besteht,\nwird `MARSS` seinem Ruf als Kriegsplanet gerecht und streut etwas Zwietracht \nin der angenehmen Gleichförmigkeit der steigendes Slopes.\nDie `MARSS` Verläufe steigen nicht ganz so stark^[Dies ist keineswegs ein horoskopisches Statement. Ich würde Ihnen aber trotzdem empfehlen in nächster Zeit keine großen Investitionen zu tätigen, denn für ihre im übernächsten Monat nun nicht mehr überraschend auf Sie zukommende Liebe, sollten Sie nicht nur finanziell unabhängig wirken, sondern dies auch sein!]. \nNoch dazu darf\n`MARSS` gleich 2 Linien in der Abbildung beitragen, weil offensichtlich\ndie gewählte Art der Optimierung (BFGS vs. KEM) wesentlich den Verlauf des \npredicts beeinflusst^[Insbesondere konvergierte `MARSS` erst nach Erhöhung der Iterationen. Bevor der Algorithmus konvergierte, war der Slope negativ! Also achten Sie auf die Warnings!].\nWir versuchen es positiv zu sehen: Wir haben nun eine Auswahl!\n\n\n<img src=\"media/smoothed_predicts.jpg\" alt=\"State Space Model\" style=\"float: right; width: 40%; margin-left: 20px; margin-bottom: 10px;\"/>\n\nDie Frage ist nur: Wie kommt das Modell zu **diesem** Slope, wenn doch im Modell\neigentlich kein fixer Slope definiert wurde? Betrachten wir das exemplarisch beim `statespacer` package. Die Frage lautet: Wie wird die Steigung festgelegt?\nWenn in R Werte vorhergesagt werden sollen, wird typischerweise die \nFunktion `predict` verwendet.\nWenn man `predict` auf ein `statespacer` Modell Objekt anwendet, wird für den\nForecast der zuletzt geschätzte Slope herangezogen -- denn es werden ja \nunterschiedliche Slopes für jeden Zeitpunkt geschätzt!\nGenauer gesagt wird nicht der\ngefilterte sondern der **gesmoothte** letzte Slope verwendet. \nDieser wird stabil in\ndie Zukunft fortgeschrieben, was genau diese Linie ergibt!\n\nSo was ist **Smoothing** jetzt eigentlich? Kurz gesagt: Beim Smoothing wird\ndie gesamte Zeitreihe verwendet. Zuerst wird **gefiltert**, dabei 'schaut' die\nZeitreihe quasi nur nach vorne. Am Ende des Filtern, wird mittels Smoothing die gesamte\nZeitreihe berücksichtigt und nachträglich geglättet und optimiert.\nDamit sollten die Forecasts noch stabiler sein!\n\n\n::: {.panel-tabset}\n\n## `statespacer`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny_spacer = dat1_drift[, .(y)] %>% as.matrix()\n\nspacer_res = statespacer::statespacer(y = y_spacer, \n                                      local_level_ind = TRUE, \n                                      slope_ind = TRUE)\n\nspacer_pred = predict(spacer_res, forecast_period = 25)\n\nforecast_dat = data.table(time = 100 + 1:25, \n                          y = spacer_pred$y_fc[,1], \n                          prediction = \"pred\")\n\nstatespacer_fullpred = c(spacer_res$smoothed$a[,1], \nspacer_pred$y_fc[,1])\n\nstatespacer_all = data.table(time = 1:125, \n                             statespacer = statespacer_fullpred)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n## `kfas`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkfas_mod <- SSModel(y ~ SSMtrend(2, \n                                 Q = list(matrix(NA), matrix(NA))), \n                    H = matrix(NA),data = dat1_drift)\nkfas_fit <- fitSSM(kfas_mod, inits = c(1, 1, 1), method = \"BFGS\")\n\nkfas_pred0 = predict(kfas_fit$model) %>% unclass\nkfas_pred = predict(kfas_fit$model, n.ahead = 25)\n\nkfas_all = data.table(rbind(kfas_pred0, kfas_pred), time = 1:(100 + nrow(kfas_pred))) %>% \n    setnames(old = \"fit\", new = \"kfas\") \n```\n:::\n\n\n## `MARSS`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nZ <- matrix(c(1, 0), nrow = 1)\nB <- matrix(c(1, 1, 0, 1), nrow = 2, byrow = TRUE)\nU <- matrix(0, nrow = 2, ncol = 1)\nA <- matrix(0, nrow = 1, ncol = 1)\nQ <- matrix(list(\"q11\", \"q12\", \"q12\", \"q22\"), nrow = 2, byrow = TRUE) # CV\nR <- matrix(\"r\", nrow = 1)\nx0 <- matrix(c(dat1_drift$y[1], 0), nrow = 2) # start\n\nV0 <- matrix(c(0, 0, 0, 0), nrow = 2, byrow = TRUE)\ndiag(V0) <- c(0.01, 0.01)\n\nmodel_list <- list(\n  Z = Z,\n  B = B,\n  U = U,\n  Q = Q,\n  R = R,\n  A = A,\n  x0 = x0,\n  V0 = V0)\n\n# fit\nfit_marss_bfgs <- MARSS(dat1_drift$y, model = model_list, method = \"BFGS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSuccess! Converged in 442 iterations.\nFunction MARSSkfas used for likelihood calculation.\n\nMARSS fit is\nEstimation method: BFGS \nEstimation converged in 442 iterations. \nLog-likelihood: -226.7545 \nAIC: 461.509   AICc: 461.93   \n \n      Estimate\nR.r    3.15960\nQ.q11  0.90252\nQ.q12  0.02620\nQ.q22  0.00076\nInitial states (x0) defined at t=0\n\nStandard errors have not been calculated. \nUse MARSSparamCIs to compute CIs and bias estimates.\n```\n:::\n\n```{.r .cell-code}\nfit_marss_kem  <- MARSS(dat1_drift$y, model = model_list, method = \"kem\", control=list(maxit=10000))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSuccess! abstol and log-log tests passed at 1439 iterations.\nAlert: conv.test.slope.tol is 0.5.\nTest with smaller values (<0.1) to ensure convergence.\n\nMARSS fit is\nEstimation method: kem \nConvergence test: conv.test.slope.tol = 0.5, abstol = 0.001\nEstimation converged in 1439 iterations. \nLog-likelihood: -226.8012 \nAIC: 461.6025   AICc: 462.0235   \n \n      Estimate\nR.r    3.22082\nQ.q11  0.81222\nQ.q12  0.02022\nQ.q22  0.00169\nInitial states (x0) defined at t=0\n\nStandard errors have not been calculated. \nUse MARSSparamCIs to compute CIs and bias estimates.\n```\n:::\n\n```{.r .cell-code}\n# predict\nmarss_pred_bfgs = predict(fit_marss_bfgs, n.ahead = 25)$pred %>% data.table\nmarss_pred_kem  = predict(fit_marss_kem, n.ahead = 25)$pred %>% data.table\n# zamhaengen\nmarss_all = marss_pred_bfgs[marss_pred_kem, marss_kem := i.estimate, on = \"t\"]\nsetnames(marss_all, old = c(\"t\",\"estimate\"), new = c(\"time\",\"marss_bfgs\"))\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Dygraph Code (Achtung lang!)\"}\n#dat_true = dat1_drift[, .(time, y, prediction = \"true\")]\n\ndat_fin = marss_all %>% copy\ndat_fin[statespacer_all, statespacer := i.statespacer, on = \"time\"]\ndat_fin[kfas_all, kfas := i.kfas, on = \"time\"]\ndat_fin[dat1_drift, true_values := i.true_values ,on = \"time\"]\n\n\ndygraph(dat_fin[, !c(\".rownames\", \"y\")], \nmain = \"Forecast mit State-Space Model with Slope\", height = 660) %>% \n    #dySeries(name = \"y\", color = \"black\", strokeWidth = 0, pointSize = 2, drawPoints = TRUE) %>% \n    dySeries(step = TRUE, name = \"true_values\", color = \"black\") %>% \n    dySeries(step = FALSE, name = \"statespacer\") %>% \n    dySeries(step = FALSE, name = \"kfas\") %>% \n    dySeries(step = FALSE, name = \"marss_bfgs\") %>% \n    dySeries(step = FALSE, name = \"marss_kem\") %>% \n    dyHighlight(highlightSeriesOpts = list(strokeWidth = 1.5)) %>% \n    dyEvent(\"100\", \"Daten / Prognose\", labelLoc = \"bottom\") %>% \n    dyRangeSelector(dateWindow = c(1, 125), \n                    fillColor = paletteer_d(\"trekcolors::starfleet\")[2],\n                    strokeColor = paletteer_d(\"trekcolors::starfleet\")[2]) %>% \n    dyOptions(colors = paletteer_d(\"trekcolors::starfleet2\"), \n              drawGrid = TRUE, \n              axisLineColor = \"grey\",\n              gridLineColor = \"lightgray\") %>% \n    dyCSS(css = \"../dygraph_css.css\") %>% \n  dyCallbacks(\n      highlightCallback = \"function(event, x, points, row, seriesName) {\n        var point = points[0];\n        var content = 'Series: ' + seriesName;\n        var hoverDiv = document.getElementById('hover-info');\n        if (!hoverDiv) {\n          hoverDiv = document.createElement('div');\n          hoverDiv.id = 'hover-info';\n          hoverDiv.className = 'hover-info'; // Apply CSS class\n          document.body.appendChild(hoverDiv);\n        }\n        hoverDiv.innerHTML = content;\n        hoverDiv.style.left = event.clientX + 20 + 'px';\n        hoverDiv.style.top = event.clientY + 20 + 'px';\n        hoverDiv.style.display = 'block';\n      }\",\n      unhighlightCallback = \"function(event) {\n        var hoverDiv = document.getElementById('hover-info');\n        if (hoverDiv) {\n          hoverDiv.style.display = 'none';\n        }\n      }\"\n    )\n```\n\n::: {#fig-ssm2-statespacer-dygraph1 .cell-output-display}\n```{=html}\n<div id=\"htmlwidget-202d1e7af8a3542bf732\" style=\"width:100%;height:638px;\" class=\"dygraphs html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-202d1e7af8a3542bf732\">{\"x\":{\"attrs\":{\"title\":\"Forecast mit State-Space Model with Slope\",\"labels\":[\"time\",\"true_values\",\"statespacer\",\"kfas\",\"marss_bfgs\",\"marss_kem\"],\"legend\":\"auto\",\"retainDateWindow\":false,\"axes\":{\"x\":{\"pixelsPerLabel\":60,\"drawAxis\":true},\"y\":{\"drawAxis\":true}},\"series\":{\"true_values\":{\"axis\":\"y\",\"stepPlot\":true},\"statespacer\":{\"axis\":\"y\",\"stepPlot\":false},\"kfas\":{\"axis\":\"y\",\"stepPlot\":false},\"marss_bfgs\":{\"axis\":\"y\",\"stepPlot\":false},\"marss_kem\":{\"axis\":\"y\",\"stepPlot\":false}},\"highlightCircleSize\":3,\"highlightSeriesBackgroundAlpha\":0.5,\"highlightSeriesOpts\":{\"strokeWidth\":1.5},\"hideOverlayOnMouseOut\":true,\"showRangeSelector\":true,\"dateWindow\":[1,125],\"rangeSelectorHeight\":40,\"rangeSelectorPlotFillColor\":\"#AD722CFF\",\"rangeSelectorPlotStrokeColor\":\"#AD722CFF\",\"interactionModel\":\"Dygraph.Interaction.defaultModel\",\"stackedGraph\":false,\"fillGraph\":false,\"fillAlpha\":0.15,\"stepPlot\":false,\"drawPoints\":false,\"pointSize\":1,\"drawGapEdgePoints\":false,\"connectSeparatedPoints\":false,\"strokeWidth\":1,\"strokeBorderColor\":\"white\",\"colors\":[\"#5B1414FF\",\"#AD722CFF\",\"#1A6384FF\",\"#2C6B70FF\",\"#483A4AFF\",\"#000000FF\"],\"colorValue\":0.5,\"colorSaturation\":1,\"includeZero\":false,\"drawAxesAtZero\":false,\"logscale\":false,\"axisTickSize\":3,\"axisLineColor\":\"grey\",\"axisLineWidth\":0.3,\"axisLabelColor\":\"black\",\"axisLabelFontSize\":14,\"axisLabelWidth\":60,\"drawGrid\":true,\"gridLineColor\":\"lightgray\",\"gridLineWidth\":0.3,\"rightGap\":5,\"digitsAfterDecimal\":2,\"labelsKMB\":false,\"labelsKMG2\":false,\"labelsUTC\":false,\"maxNumberWidth\":6,\"animatedZooms\":false,\"mobileDisableYTouch\":true,\"disableZoom\":false,\"highlightCallback\":\"function(event, x, points, row, seriesName) {\\n        var point = points[0];\\n        var content = 'Series: ' + seriesName;\\n        var hoverDiv = document.getElementById('hover-info');\\n        if (!hoverDiv) {\\n          hoverDiv = document.createElement('div');\\n          hoverDiv.id = 'hover-info';\\n          hoverDiv.className = 'hover-info'; // Apply CSS class\\n          document.body.appendChild(hoverDiv);\\n        }\\n        hoverDiv.innerHTML = content;\\n        hoverDiv.style.left = event.clientX + 20 + 'px';\\n        hoverDiv.style.top = event.clientY + 20 + 'px';\\n        hoverDiv.style.display = 'block';\\n      }\",\"unhighlightCallback\":\"function(event) {\\n        var hoverDiv = document.getElementById('hover-info');\\n        if (hoverDiv) {\\n          hoverDiv.style.display = 'none';\\n        }\\n      }\"},\"annotations\":[],\"shadings\":[],\"events\":[{\"pos\":\"100\",\"label\":\"Daten / Prognose\",\"labelLoc\":\"bottom\",\"color\":\"black\",\"strokePattern\":[7,3],\"axis\":\"x\"}],\"format\":\"numeric\",\"data\":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125],[1,0.6857683040495275,3.082570976555704,2.468913754909643,0.8206691793103875,-0.1117392078046471,-0.7094410803710014,0.7694392468881133,1.417649678376644,1.739675728327591,2.503638751439906,1.752860128931518,0.844163041523363,0.9272340731667997,3.055992646480466,2.903638328634336,4.651860285324537,6.050030458607454,6.052965317053991,6.036460292264542,6.880536634711769,7.297727884348036,9.768260925884913,10.18130079556378,8.963998388206878,8.644003220233289,8.441726942385454,7.653936574992412,8.361506749723059,9.797410650181195,10.31648710205737,11.92631332813661,11.97514289717576,13.28884201301083,13.12325603677047,13.24755517949979,12.60359543453837,13.46692619018665,14.38646264369197,15.26484013531942,15.04587173709581,15.64197560917146,15.37545025336079,14.99877915548079,14.97474187511055,17.29648113904341,17.68575502910611,18.90645441360092,17.6447178628185,19.17996525789449,20.59117681954267,20.84145939274026,21.31094056860081,21.09992210825179,21.51498493650756,20.34542522130209,20.24176705104238,19.62143770431343,19.9218155402413,19.31662560713727,19.04001992792034,18.97187462063151,18.75476890785106,18.38849948377434,20.14748670483082,21.41477279329971,22.32738494369963,22.21952770231125,22.14032316538445,22.86045090749418,23.80502054275206,25.20731190671528,27.30885321426985,29.00954309567108,27.3370138984282,28.58850571257966,28.22656585307534,27.18560116972419,27.34344832876712,28.39453518236474,28.67186278373353,28.77523020985811,27.94449027737225,27.45679037052805,27.45379577996776,26.08223846999272,26.75912172868371,26.26795983751611,28.42859279651375,28.92763515646161,29.68781469225239,29.71609698543485,29.08189286148369,27.72473896479746,27.394661709777,26.7865165511056,26.96320345487156,25.67485733812143,24.56580033810704,22.9809642067333,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[0.4636065272342844,0.785099131453971,0.9267425953172992,0.9705640831763716,0.946867826032141,1.028063655544346,1.513844409100045,1.242948921147842,0.5525789917811395,0.2914294927537708,0.8962333485484193,1.487249804977401,1.565487348749402,2.233201169336682,2.955423296320055,4.003107615047983,5.126148723111346,5.912994016565249,6.125498665504542,6.377280030667158,6.846566864354621,7.733182122856542,8.004544934511607,8.70311517550841,9.130612634552302,8.76660431893453,9.02507568705947,9.142879216771938,9.140123109958862,9.993930691677845,11.02886296443677,11.81341481067043,12.4456540716841,13.09793642266776,13.47906766988183,13.68321164244956,13.6794340293955,13.89718232857409,14.2110851300504,14.84263410948928,14.94397008526199,15.15301508367071,15.00898891501496,15.58326505892323,16.51173788206196,17.35801399595774,18.01222238815799,18.1626864045519,18.52505679240427,18.60748666736673,18.85742982108241,19.31529163321687,19.64044222995613,20.00598080886317,20.2196901606878,20.44000727615041,21.01141753681003,20.77006758669921,20.32930966591923,20.3307066879054,20.27034598691288,20.04631750425797,19.77341816012309,19.65070471191881,19.92391520753394,21.18424447767556,22.14471818257539,21.87040376932744,21.8233357931963,21.82320200163702,22.65316044410966,23.58272284167538,24.84973039845426,25.52837677069921,26.24866690136462,26.81902139764826,27.01488118958095,27.81726128688532,28.37834413723866,28.41521687349098,28.62128803757118,28.81594969846526,28.93637721654026,28.88345781322959,27.81268254111011,27.02069485650951,26.75570924365215,26.45254086881184,27.20897912578343,27.90332792142322,28.15193521080876,27.95652372063466,27.58775714928527,27.5794868197597,27.9323052542072,27.95715851411893,27.31206151979045,26.28879400966337,26.00432038902663,25.37226977783686,25.50970624247722,25.64714270711758,25.78457917175794,25.9220156363983,26.05945210103866,26.19688856567902,26.33432503031938,26.47176149495974,26.6091979596001,26.74663442424045,26.88407088888081,27.02150735352117,27.15894381816153,27.29638028280189,27.43381674744225,27.57125321208261,27.70868967672297,27.84612614136333,27.98356260600369,28.12099907064405,28.25843553528441,28.39587199992476,28.53330846456512,28.67074492920548,28.80818139384584],[0.4647165833016544,0.7860661871061236,0.9274587602429714,0.971021142927643,0.9470423266874088,1.028211655805377,1.514848014139624,1.243461042133245,0.5518182408843222,0.2900390956721717,0.8955953362285396,1.487090524849925,1.564611215156686,2.232553396151139,2.95488099918616,4.00316455921914,5.126952042037065,5.914043466020095,6.125866457084696,6.37715014140489,6.846359829787938,7.733725573158973,8.004690548643332,8.703822784373035,9.131521052415772,8.766301693060724,9.024804820328487,9.142262804886002,9.138723436865636,9.993163137517961,11.02889422650525,11.81373461600623,12.44605365577292,13.0986041388039,13.47965458640468,13.68354787596842,13.67920969617694,13.89683641450307,14.21075235780411,14.84292510002561,14.9438720886242,15.15276015703837,15.00777967288868,15.58230701601913,16.511537778584,17.35837788502256,18.01289494869992,18.16284374035934,18.52525134344373,18.60723442292646,18.85706927699876,19.31521598453173,19.64040350641422,20.00611186746412,20.21976450599216,20.44011898924663,21.01240495009628,20.77054346100608,20.32903786399742,20.33059070902494,20.27025346962473,20.04589844066529,19.77246381991766,19.64926694016959,19.92242422427115,21.18437691795534,22.14589152043234,21.87035459485257,21.82255928751612,21.82159599685052,22.65205193139917,23.5820367285189,24.85003531180636,25.52857329030146,26.24897914117163,26.81930991333793,27.01452970396252,27.81756370350958,28.37898672990959,28.4153882668565,28.62151852728249,28.8164023362826,28.93714517278304,28.88451190704983,27.8122697064078,27.01938224402305,26.7543163973035,26.45065048988651,27.20836369175891,27.90374531444013,28.15263232750014,27.95683405079646,27.58747471719201,27.57936494314269,27.9331419251428,27.95856101429506,27.31306738140331,26.28893350869343,26.00523390581649,25.37349279519575,25.51322763903799,25.65296248288022,25.79269732672245,25.93243217056469,26.07216701440692,26.21190185824916,26.35163670209139,26.49137154593362,26.63110638977586,26.77084123361809,26.91057607746033,27.05031092130256,27.1900457651448,27.32978060898703,27.46951545282926,27.6092502966715,27.74898514051373,27.88871998435597,28.0284548281982,28.16818967204043,28.30792451588267,28.4476593597249,28.58739420356714,28.72712904740937,28.8668638912516],[0.374561987619378,0.374561987619378,0.7512094630866625,0.9803856040104516,1.101252133042274,0.8970747376941953,0.3442462154527596,2.036825460555119,2.395013600538978,0.9828916676102034,-0.6463996514991517,0.02022689717311548,1.448557309092418,0.6217629887319429,1.252448817416151,1.52316084999047,2.527941837189905,4.24858380056466,5.976758286337525,6.142870506709969,6.071930609269578,5.922461138081702,7.807090794503446,7.432200459415986,8.584107786418242,10.24820661016745,8.894560509068949,9.372032814726456,9.669624325488309,8.337482506738503,8.95195201398051,10.42433788393057,11.48219400044993,12.11321432948771,13.21094772478366,13.87549275036226,14.39780723334327,14.03900694462205,14.10539369224602,13.93399654529509,15.39951520826368,15.32683182315085,16.0730322716682,14.80295032566988,14.84993506562556,15.94286375712488,17.11955332729759,18.57100087940957,18.39208339497794,19.18802037904473,19.0016902784125,18.92916315493221,19.59820272987443,19.86259724182212,20.4638883878467,20.66203714121481,20.33911459155026,22.16913664061509,22.20192964299881,21.03902761664408,21.11316496688332,21.27924798541657,21.09728838702806,20.5590318853254,19.80368169512411,18.56323974571328,20.33864239994831,23.23336199933971,22.5864265022706,22.45080498141114,21.16478247549835,21.87359073040289,22.32698082749941,24.55559575597481,25.20019818196216,26.17990406332027,27.34338304009652,26.6082202864181,27.80857040411538,29.18770555158883,28.95105080082549,29.16676346004652,29.4658245787901,29.83771538497152,31.31811769035054,29.73826586256566,28.06900402168503,27.82109382692872,25.85611822186244,26.72893698440711,28.12898835162243,29.05818596054122,29.10357747793983,28.14693514029108,27.56871786369663,28.42722456954736,29.46460967430084,29.34757809457567,27.11951793300659,27.33169676088504,25.47022311836524,25.58232321595198,25.69442331353871,25.80652341112544,25.91862350871218,26.03072360629891,26.14282370388564,26.25492380147238,26.36702389905911,26.47912399664584,26.59122409423258,26.70332419181931,26.81542428940604,26.92752438699278,27.03962448457951,27.15172458216624,27.26382467975298,27.37592477733971,27.48802487492644,27.60012497251317,27.71222507009991,27.82432516768664,27.93642526527337,28.04852536286011,28.16062546044684],[0.374561987619378,0.374561987619378,0.7233531826646471,0.9490390922798783,1.075934766081053,0.8905754175951607,0.361844862991529,1.983839018814449,2.354348244101872,1.008687122122673,-0.5831937873254729,0.02895934187882632,1.409016969150858,0.6220292414395533,1.23460680679968,1.508058204255199,2.500804485402738,4.208390922734145,5.944078412743981,6.158906323528386,6.120509011428155,5.988370619378372,7.84631336239502,7.507524834466931,8.650907097703527,10.31193435783811,9.011904717702805,9.477392237400062,9.771422788050947,8.456038410142643,9.037981638789024,10.48529550987981,11.5469395418999,12.19341146076812,13.29862980262111,13.98042384038179,14.51704089703397,14.17564421903994,14.23793490896355,14.06134767651233,15.50182420232737,15.44082254634538,16.18045187437114,14.92697855198353,14.95118867573209,16.01815241707853,17.18841854070675,18.6443565574917,18.49381612427412,19.2908804088617,19.11678534428612,19.04197348322545,19.6974474098643,19.95975871437007,20.55516715000397,20.75482274818626,20.4331339797152,22.23937829715475,22.28905633723009,21.13842047752831,21.19027487106739,21.33851746194266,21.14576989473828,20.59654452129625,19.824875119437,18.56438173678587,20.28969025456846,23.16997101275892,22.57317315334439,22.45148440174018,21.17537196164992,21.85700837101106,22.30286896797041,24.51957230046755,25.1939426134148,26.19384545353276,27.37681345133058,26.67519165816422,27.86800418362942,29.25241468342424,29.04128838054314,29.25964612991577,29.55635778216225,29.92423733277585,31.39454426793723,29.84077275750168,28.1594501480136,27.86791370346077,25.87985033327041,26.69236275106821,28.0636911010409,28.99584046989255,29.05839418189066,28.11557840610504,27.52757605349003,28.36192601778831,29.39402382443145,29.2928109784689,27.08252808223235,27.25861337628665,25.39002625765341,25.42608450816035,25.46214275866729,25.49820100917422,25.53425925968116,25.5703175101881,25.60637576069503,25.64243401120197,25.67849226170891,25.71455051221584,25.75060876272278,25.78666701322972,25.82272526373665,25.85878351424359,25.89484176475053,25.93090001525746,25.9669582657644,26.00301651627134,26.03907476677827,26.07513301728521,26.11119126779215,26.14724951829908,26.18330776880602,26.21936601931296,26.25542426981989]],\"fixedtz\":false,\"tzone\":\"\",\"css\":\"\\n@import url('https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');\\n\\n\\n.dygraph-title {\\nfont-family: 'Barlow Semi Condensed', serif;\\n  font-weight: 400;\\n  font-style: normal;\\n  text-align: left;\\n  font-size: 24px;\\n  text-indent: 67px;\\n  transform: translateY(-6px);\\n}\\n\\n.dygraph-axis-label {\\nfont-family: 'Barlow Semi Condensed', serif;\\n  font-weight: 200;\\n  font-style: normal;\\n    font-size: 12px;\\n}\\n\\n#hover-info {\\n  font-family: 'Barlow Semi Condensed', sans-serif;\\n  position: absolute;\\n  border: 1px solid black;\\n  background: white;\\n  padding: 5px;\\n  display: none;\\n  z-index: 1000;\\n}\\n\"},\"evals\":[\"attrs.interactionModel\",\"attrs.highlightCallback\",\"attrs.unhighlightCallback\"],\"jsHooks\":[]}</script>\n```\n\n\nBeobachtete Forecast mit statspacer, KFAS und MARSS.\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\nWas haben wir nun am Ende des Tages?\nEin Modell mit dem wir einen Slope, zwecks predict, aus der Zeitreihe extrahieren können.\nWir nutzen also die Komplexität des Modells um einen Slope zu schätzen \nmit dem wir die Zukunft beschreiben können, natürlich mit allen Vorbehalten\ndie man (immer) haben sollte wenn man mit Daten und mit Modellen arbeitet. \n\n\n\n<br>\n\n::: {style='text-align:center;'}\n\n\n{{< bi cpu-fill size=66px color=#AD722CFF >}}\n\n\n\n:::\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/jquery-1.11.1/jquery.min.js\"></script>\n<link href=\"../../../site_libs/dygraphs-1.1.1/dygraph.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/dygraphs-1.1.1/dygraph-combined.js\"></script>\n<script src=\"../../../site_libs/dygraphs-1.1.1/shapes.js\"></script>\n<script src=\"../../../site_libs/moment-2.8.4/moment.js\"></script>\n<script src=\"../../../site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js\"></script>\n<script src=\"../../../site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js\"></script>\n<script src=\"../../../site_libs/dygraphs-binding-1.1.1.6/dygraphs.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}