<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Manuel">
<meta name="dcterms.date" content="2024-01-22">
<meta name="description" content="Wie aus Quarto Präsentationen mit revealjs automatisiert pdfs und Handouts werden.">

<title>Manuel Reif - Presentation pipeline</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Manuel Reif</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv/reif_cv.pdf" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pkgs.html" rel="" target="">
 <span class="menu-text">R-Packages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog <i class="fa-solid fa-blog" aria-label="blog"></i></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bi-fullscreen-folien-folien-folien" id="toc-bi-fullscreen-folien-folien-folien" class="nav-link active" data-scroll-target="#bi-fullscreen-folien-folien-folien"><i class="bi-fullscreen " style="" role="img" aria-hidden="true"></i> Folien, Folien, Folien</a></li>
  <li><a href="#bi-file-play-rendern" id="toc-bi-file-play-rendern" class="nav-link" data-scroll-target="#bi-file-play-rendern"><i class="bi-file-play " style="" role="img" aria-hidden="true"></i> Rendern</a></li>
  <li><a href="#bi-file-earmark-pdf-pdfs-erstellen" id="toc-bi-file-earmark-pdf-pdfs-erstellen" class="nav-link" data-scroll-target="#bi-file-earmark-pdf-pdfs-erstellen"><i class="bi-file-earmark-pdf " style="" role="img" aria-hidden="true"></i> pdfs erstellen</a></li>
  <li><a href="#bi-hand-index-thumb-pdf-handout" id="toc-bi-hand-index-thumb-pdf-handout" class="nav-link" data-scroll-target="#bi-hand-index-thumb-pdf-handout"><i class="bi-hand-index-thumb " style="" role="img" aria-hidden="true"></i> pdf handout</a></li>
  <li><a href="#bi-record-ein-skript-um-alles-zu-builden" id="toc-bi-record-ein-skript-um-alles-zu-builden" class="nav-link" data-scroll-target="#bi-record-ein-skript-um-alles-zu-builden"><i class="bi-record " style="" role="img" aria-hidden="true"></i> Ein Skript um alles zu builden</a></li>
  <li><a href="#bi-signpost-2-platzierung-des-python-skripts" id="toc-bi-signpost-2-platzierung-des-python-skripts" class="nav-link" data-scroll-target="#bi-signpost-2-platzierung-des-python-skripts"><i class="bi-signpost-2 " style="" role="img" aria-hidden="true"></i> Platzierung des Python Skripts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Presentation pipeline</h1>
  <div class="quarto-categories">
    <div class="quarto-category">quarto</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">bash</div>
    <div class="quarto-category">Linux</div>
  </div>
  </div>

<div>
  <div class="description">
    Wie aus Quarto Präsentationen mit revealjs automatisiert pdfs und Handouts werden.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Manuel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="bi-fullscreen-folien-folien-folien" class="level1">
<h1><i class="bi-fullscreen " style="" role="img" aria-hidden="true"></i> Folien, Folien, Folien</h1>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="bi-book-half " style="font-size: 25px;" role="img" aria-hidden="true"></i> Soll ich lesen?
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Erstellst du Folien mit reveal-js mittels quarto? <br></li>
<li>Willst du pdf Versionen und pdf Handouts? <br></li>
<li>Arbeitest du mit Linux/Ubuntu. <br></li>
<li>Dann Lesebefehl!</li>
</ol>
</div>
</div>
<p><img src="pipeline.png" alt="Bildbeschreibung" style="float: right; width: 37%; margin-left: 20px; margin-bottom: 10px;"></p>
<p>In meiner Lehrveranstaltung zu “Forschungsmethoden und Statistik” habe ich meine Folien mithilfe von <code>quarto</code> und <code>revealjs</code> erstellt. Das war natürlich nicht immer so. Früher, in der guten alten Zeit, habe ich wie jeder vernünftige Mensch meine Folien mit LaTeX <code>beamer</code> erstellt. 2023 sprach allerdings kaum mehr etwas dafür <code>beamer</code> zu verwenden, denn alle Präsentation mit <code>revealjs</code> sahen einfach gut aus – und das quasi “Out of the box”. Also musste ich einen neuen Workflow aufbauen. Die <code>quarto</code> Dokumente schreibe ich in RStudio und zur schnellen Ansicht rendere ich auch direkt in RStudio. Das Ergebnis sind .html files. Ich brauche aber ebenso Handouts für meine Studierenden und hätte selbst gerne noch eine .pdf Version meiner Präsentation falls alle Browser streiken und Gott bewahre, etwas ähnliches ist mir bereits passiert. Üblicherweise trage ich meine files auf einem USB Stick herum. USB-Sticks bleiben gerne mal wo liegen oder stecken und daher wäre es gut, ein vernünftiges Backup in der Cloud zu haben, um im Falle des Falles auch so auf die Präsentation zugreifen zu können.</p>
<p>Dieser Post wird sich damit beschäftigen, einen für mich funktionierenden automatisierten Ablauf für meine <code>quarto</code> Präsentationen zu erstellen. Dieser Ablauf soll folgendermaßen geschehen:</p>
<ol type="1">
<li>Render meine <code>quarto</code> Präsentationen</li>
<li>Erstelle pdfs aus diesen</li>
<li>Erstelle pdf Handouts</li>
<li>Erstelle ein Backup auf google drive</li>
</ol>
<p>Bisher hatte ich für solche Aufgaben Makefiles. Damit bin ich nicht so schlecht gefahren – allerdings musste ich die Makefiles immer wieder anpassen bzw. in einen neuen Ordner kopieren wenn eine neue Präsentation erstellt wird. Außerdem sagt mir jeder ich muss mehr in Python machen. Ok, unter der Bedingung ich schreib mir so einen Ablauf in Python, dann will ich folgendes:</p>
<ol type="1">
<li>Multiple <code>.qmd</code> Files sollen parallel gerendert etc. werden</li>
<li>Das Herumkopieren find ich nicht so prickelnd – daher wäre es toll wenn ich den Prozess direkt aus der bash triggern könnte.</li>
<li>Naja und es soll in <code>Python</code> passieren.</li>
</ol>
</section>
<section id="bi-file-play-rendern" class="level1">
<h1><i class="bi-file-play " style="" role="img" aria-hidden="true"></i> Rendern</h1>
<p>Das ist vermutlich der einfachste Part. Man muss nur sicherstellen <code>quarto</code> installiert zu haben. Am besten man holt sich das neueste <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>, dann hat man <code>quarto</code> bereits an Board, oder man installiert es sich separat<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Man kann nun:</p>
<ol type="1">
<li>RStudio verwenden um das <code>.qmd</code> zu schreiben und auf den “render” Button drücken</li>
<li>Was viel cooler ist: in der bash rendern.</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#| echo: true</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="ex">quarto</span> render FILE.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der bash rendern ist nicht nur cooler, sondern auch der erste Schritt um das ganze Prozedere zu automatisieren. So far so good. Die pdfs zu erstellen wird ein wenig schwieriger.</p>
</section>
<section id="bi-file-earmark-pdf-pdfs-erstellen" class="level1">
<h1><i class="bi-file-earmark-pdf " style="" role="img" aria-hidden="true"></i> pdfs erstellen</h1>
<p>Ich hab viel Zeit mit google verbracht um dieses Problem zu lösen. Ziel ist es html slides automatisch zu einem pdf zu konvertieren. <a href="https://github.com/astefanutti/decktape">Decktape</a> ist dafür ein wirklich ausgezeichnetes tool. Für decktape gibt es auch einen <a href="https://hub.docker.com/r/astefanutti/decktape">Dockercontainer</a> was eine Anwendung wirklich einfach macht. Man muss sich nicht darüber Gedanken machen, welche obskure andere Software man noch installieren muss, weil alles schon mit dem Dockercontainer verschifft wird und zwar genau in den sicheren Hafen unseres Computers.</p>
<p>Also folgende To-Dos:</p>
<ol type="1">
<li><a href="https://docs.docker.com/get-docker/">Docker holen</a></li>
<li>Docker image <a href="https://docs.docker.com/engine/reference/commandline/image_pull/">pullen</a></li>
<li>Docker image verwenden <span class="math inline">\(\rightarrow\)</span> das ist genau was wir jetzt machen werden</li>
</ol>
<p>Um jetzt eine html Präsentation (revealjs) in pdf Folien zu verwandeln übergebe ich den folder an den docker container. Und das funktioniert folgendermaßen:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#| echo: true</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="ex">docker</span> run <span class="at">--rm</span> <span class="at">-t</span> <span class="at">-v</span> path/to/folder:/slides astefanutti/decktape <span class="at">--size</span><span class="op">=</span><span class="st">'2048x1536'</span> reveal FILE.html FILE.pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Was passiert hier?</p>
<ol type="1">
<li><code>docker run</code> okay, wir wollen irgendwas in docker machen, also soll der container der später genannt wird (<code>astefanutti/decktape</code>) laufen</li>
<li><code>--rm</code> es wird saubergemacht nachdem docker fertig ist</li>
<li><code>-t</code> damit sehen wir was passiert (stdin and stdout werden attached)</li>
<li><code>-v</code> wir wollen was mounten und zwar: <code>ordner/auf/meinem/computer:/container</code>. Der container rechtnet damit, dass das html file im Ordner “slides” liegt, daher wird der Ordner vom eigenen Rechner dort reingemountet.</li>
<li><code>--size='2048x1536'</code> so funktioniert es bei mir. Andere Einstellungen machen Probleme.</li>
<li><code>reveal</code> offensichtlich arbeiten wir mit reveal-js.</li>
<li><code>FILE.html FILE.pdf</code> hier dürfen wir noch einen Namen vergeben für das pdf</li>
</ol>
<p>Das Ergebnis ist <code>FILE.pdf</code>, eine pdf Verison der html Präsentation.</p>
</section>
<section id="bi-hand-index-thumb-pdf-handout" class="level1">
<h1><i class="bi-hand-index-thumb " style="" role="img" aria-hidden="true"></i> pdf handout</h1>
<p>Um Handouts zu erstellten, die 4 Folien auf einer Seite darstellen, verwenden wir <a href="https://github.com/rrthomas/pdfjam">pdfjam</a>. Das geht ratz-fatz. Kaum hat man auf Enter gedrückt ist das file auch schon da. Wir brauchen nur die dargestellte Zeile um ein Handout zu erhalten.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#| echo: true</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ex">pdfjam</span> <span class="at">--nup</span> 2x2 <span class="at">--landscape</span> <span class="at">--a4paper</span> FILE.pdf <span class="at">--outfile</span> HANDOUT.pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bi-record-ein-skript-um-alles-zu-builden" class="level1">
<h1><i class="bi-record " style="" role="img" aria-hidden="true"></i> Ein Skript um alles zu builden</h1>
<p>Jetzt haben wir alle einzelnen Schritte beisammen um unsere Präsentation zu erstellen, eine pdf Version und ein Handout. Das ist gut, allerdings wollen wir das natürlich nicht jedesmal händisch ausführen, sondern ein Skript anfertigen, das die Schritte automatisiert macht. Ich habe manchmal auch mehrere Quarto Präsentationsfiles in einem Ordner liegen und möchte nicht jedes Mal darüber nachdenken welches ich nun rendern will. Das Skript sollte also folgendes können:</p>
<ol type="1">
<li>render – decktape – pdfjam</li>
<li>für alle quarto files im Ordner</li>
<li>parallel (da die Files z. T. längere Laufzeiten haben und mein Laptop &gt; 10 Kerne hat) – es ist mir kurz gesagt egal ob er tw. umsonst rendert, ich will nur keine Zeit damit verschwenden über irgendwelche Files nachzudenken.</li>
</ol>
<p>Das hier gezeigte Python Skript definiert eine Funktion <code>process_file</code> die im wesentlichen 3 Befehle ausführt: render – decktape – pdfjam. Die Dateinamen werden von den <code>quarto</code> Quarto Dokumenten übernommen und die Endungen angepasst. Um alles parallel ablaufen zu lassen wird hier der <code>ThreadPoolExecutor</code> verwendet.</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Python</strong></pre>
</div>
<div class="sourceCode" id="annotated-cell-4"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2"></a><span class="co">#| echo: true</span></span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3"></a></span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor</span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5"></a><span class="im">import</span> os</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6"></a><span class="im">import</span> glob</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7"></a><span class="im">import</span> re</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8"></a><span class="im">import</span> sys</span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-10" class="code-annotation-target"><a href="#annotated-cell-4-10"></a>args <span class="op">=</span> sys.argv[<span class="dv">1</span>:]</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11"></a></span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12"></a><span class="kw">def</span> process_file(val): <span class="co"># Function</span></span>
<span id="annotated-cell-4-13"><a href="#annotated-cell-4-13"></a>    new_file_html <span class="op">=</span> re.sub(<span class="st">"qmd$"</span>, <span class="st">"html"</span>, val)</span>
<span id="annotated-cell-4-14"><a href="#annotated-cell-4-14"></a>    new_file_pdf <span class="op">=</span> re.sub(<span class="st">"qmd$"</span>, <span class="st">"pdf"</span>, val)</span>
<span id="annotated-cell-4-15"><a href="#annotated-cell-4-15"></a>    new_file_handout_pdf <span class="op">=</span> re.sub(<span class="st">".qmd$"</span>, <span class="st">"_handout.pdf"</span>, val)</span>
<span id="annotated-cell-4-16"><a href="#annotated-cell-4-16"></a>    </span>
<span id="annotated-cell-4-17"><a href="#annotated-cell-4-17"></a>    run_quarto <span class="op">=</span> <span class="st">"quarto render "</span> <span class="op">+</span> val</span>
<span id="annotated-cell-4-18"><a href="#annotated-cell-4-18"></a>    run_pdf <span class="op">=</span> <span class="ss">f"docker run --rm -t -v </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">:/slides -v :</span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss"> astefanutti/decktape --size='2048x1536' reveal </span><span class="sc">{</span>new_file_html<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>new_file_pdf<span class="sc">}</span><span class="ss">"</span></span>
<span id="annotated-cell-4-19"><a href="#annotated-cell-4-19"></a>    run_pdf_handout <span class="op">=</span> <span class="ss">f"pdfjam --nup 2x2 --landscape --a4paper </span><span class="sc">{</span>new_file_pdf<span class="sc">}</span><span class="ss"> --outfile </span><span class="sc">{</span>new_file_handout_pdf<span class="sc">}</span><span class="ss">"</span></span>
<span id="annotated-cell-4-20"><a href="#annotated-cell-4-20"></a>    </span>
<span id="annotated-cell-4-21"><a href="#annotated-cell-4-21"></a>    os.system(run_quarto) <span class="co"># render</span></span>
<span id="annotated-cell-4-22"><a href="#annotated-cell-4-22"></a>    os.system(run_pdf) <span class="co"># decktape</span></span>
<span id="annotated-cell-4-23"><a href="#annotated-cell-4-23"></a>    os.system(run_pdf_handout) <span class="co"># pdfjam</span></span>
<span id="annotated-cell-4-24"><a href="#annotated-cell-4-24"></a></span>
<span id="annotated-cell-4-25"><a href="#annotated-cell-4-25"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="annotated-cell-4-26"><a href="#annotated-cell-4-26"></a>    file_path <span class="op">=</span> os.getcwd()</span>
<span id="annotated-cell-4-27"><a href="#annotated-cell-4-27"></a>    quarto_files <span class="op">=</span> <span class="st">"*.qmd"</span></span>
<span id="annotated-cell-4-28"><a href="#annotated-cell-4-28"></a>    matching_files <span class="op">=</span> glob.glob(os.path.join(file_path, quarto_files))</span>
<span id="annotated-cell-4-29"><a href="#annotated-cell-4-29"></a>    file_names <span class="op">=</span> [os.path.basename(pth) <span class="cf">for</span> pth <span class="kw">in</span> matching_files]</span>
<span id="annotated-cell-4-30"><a href="#annotated-cell-4-30"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-31" class="code-annotation-target"><a href="#annotated-cell-4-31"></a>    <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="dv">4</span>) <span class="im">as</span> executor:</span>
<span id="annotated-cell-4-32"><a href="#annotated-cell-4-32"></a>        executor.<span class="bu">map</span>(process_file, file_names)</span>
<span id="annotated-cell-4-33"><a href="#annotated-cell-4-33"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-34" class="code-annotation-target"><a href="#annotated-cell-4-34"></a><span class="cf">if</span> args[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"save"</span>:</span>
<span id="annotated-cell-4-35"><a href="#annotated-cell-4-35"></a>    <span class="bu">print</span>(<span class="st">"backup to google drive"</span>)</span>
<span id="annotated-cell-4-36"><a href="#annotated-cell-4-36"></a>    os.system(<span class="st">"bash -i -c backupLV2google"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-annotation="1" data-code-lines="10">Argumente werden eingesammelt. Ziel ist es einen Input zu ermöglichen in der Form: <code>render_praes save</code> bzw. <code>render_praes</code>. Wenn ‘save’ angegeben ist, dann soll von dem Folder auch ein backup gemacht werden (das wird hier jetzt nicht im Detail dargestellt).</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-annotation="2" data-code-lines="31">Hier hat mir als Noob ChatGPT geholfen. Meine schön programmierte Schleife wurde zu diesem Konstrukt umformuliert.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-annotation="3" data-code-lines="34">Wenn ‘save’ angegeben wird, wird dieser Block getriggert.</span>
</dd>
</dl>
</section>
<section id="bi-signpost-2-platzierung-des-python-skripts" class="level1">
<h1><i class="bi-signpost-2 " style="" role="img" aria-hidden="true"></i> Platzierung des Python Skripts</h1>
<p>Um dieses Skript ohne copy/paste in unterschiedlichen Projekten verwenden zu können, will ich es zentral zur Verfügung stellen und zwar so, dass es immer wenn eine Linux Terminal geöffnet wird zur Verfügung steht. Wie machen wir das?</p>
<ol type="1">
<li>Wechsle in das Verzeichnis in dem das Skript liegt <code>cd da/is/mein/skript</code></li>
<li>Mache das Python Skript ausführbar: <code>chmod +x render_praes.py</code></li>
<li>Kopiere/verschiebe das Skript an einen zentraleren Ort (ist nicht unbedingt notwendig). Skripts werden gerne zentral im <code>~/bin</code> Ordner gespeichert. Kann man machen, muss man aber nicht. Wenn man das will (ich empfehle es zu wollen), und hat keinen derartigen Ordner, macht an zuerst <code>mkdir bin</code> und dann <code>cp render_praes.py ~/bin</code> um das Skript reinzukopieren.</li>
<li>Dann fügt man einen <code>alias</code> in die <code>~/.bashrc</code> ein. Das ist der Moment, in dem man sich entscheiden muss mit welchem Namen man dieses Skript aufrufen will. Hier ist der Name mit <code>render_praes</code> festgelegt.</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>~/.bashrc</strong></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#| echo: true</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="bu">alias</span> render_praes=<span class="st">'/home/manuel/bin/render_praes_parallel.py'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Um die Funktion auszuprobieren startet man ein neues Terminal, wechselt in den Ordner mit zumindest einer Quarto revealjs Präsentation und schreibt <code>render_preas</code>. Boom <i class="bi-rocket " style="" role="img" aria-hidden="true"></i>. Es sollte nun zuerst quarto rendern, decktape das pdf erzeugen und pdfjam anschließend das Handout. Und währenddessen kann man mal gemütlich einen Kaffee trinken gehen.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Unter Linux muss man sich ein .deb file downloaden und das installieren. Ich würde RStudio empfehlen.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>